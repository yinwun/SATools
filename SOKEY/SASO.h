#pragma once
#include <atlstr.h>
#include <iostream>
#include <stdio.h>
#include <stdlib.h>

class SASO
{
public:
	SASO(CString serverKey);
	~SASO();

	char* RunningKey();

private:
	int Seed = 0x0;
	CString keycstr;
	int v5dc5E8 = 0x6;
	int v5dc6b4 = 0x0;
	int key[8];
	int Arry774[8] =
	{
		0x00, 0x00, 0x00, 0x00,
		0x00, 0x00, 0x00, 0x00
	};
	int Arry664[4] =
	{
		0x00, 0x00, 0x00, 0x00
	};
	int Arry6B4[68] =
	{
		0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
		0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
		0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
		0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
		0x00, 0x00, 0x00, 0x00
	};
	int Arry674[64] =
	{
		0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
		0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
		0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
		0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00
	};
	int Arry5E8[6] = { 0x00, 0x00, 0x00, 0x00, 0x00, 0x00 };
	int arry5E4[4] = { 0x00, 0x00, 0x00, 0x00 };

	void GenerateToken();
	void GenerateKey();
	void GenerateKey70To73();
	void Generate674And5E8();
	void Generate5E4();
	void GenerateBody();
	void Clear5E4To5E8();
	void GenerateRunningKey();

};